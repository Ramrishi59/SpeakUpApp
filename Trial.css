/* =========================================================
   Speak Up â€” Trial.css (clean, consolidated)
   ========================================================= */

/* ------------------------------
   Vars
------------------------------ */
:root{
  --sky1:#bde7ff;
  --sky2:#9dd8ff;
  --text:#333;
  --accent-red:#ff6f61;
  --accent-orange:#ffb300;
  --accent-green:#1fb573;
  --salmon:#ff7f61;
  --white:#fff;

  --font-heading:'Fredoka','Baloo 2','Comic Neue',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  --font-body:   'Fredoka','Comic Neue','Baloo 2',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;

  --card-radius:20px;
  --shadow:0 6px 18px rgba(0,0,0,.12);
  --max-content:960px;
  --header-h:56px;

  /* Slide image/text sizing */
  --img-cap: 40svh;
  --img-scale: 1;
  --img-nudge: 0svh;
  --img-shift: 12px;          /* visual downward shift for the image */
  /* unified transform inputs so we can animate without clobbering */
  --base-shift: calc(var(--img-nudge) + var(--img-shift));
  --base-scale: var(--img-scale);

  /* Legacy button typography (kept for safety) */
  --btn-h: 68px;
  --btn-font: 20px;
  --btn-pad-x: 22px;
  --btn-gap: 18px;

  --fx-dur-short: 320ms;
  --fx-dur: 800ms;
  --fx-ease: cubic-bezier(.2,.8,.2,1);

  /* Coins: single source of truth */
  --coin-size: 96px;
  --coin-gap: clamp(28px, 8vw, calc(var(--coin-size) * 0.6));
    /* space reserved when the footer is visible */
    --footer-pad: calc(var(--coin-size) + 24px);

    --intro-mascot-cap: 44svh;    /* slightly shorter to cut excess gap */
    --intro-mascot-scale: 1.14;   /* make the mascot bigger */
    --intro-mascot-shift: 0svh;   /* minimal downward shift (sit higher) */
}

/* ------------------------------
   Base
------------------------------ */
*{ box-sizing:border-box; }
html,body{
  height:100dvh;
  overflow: hidden;
  overscroll-behavior: none;
  -webkit-overflow-scrolling: auto;
  touch-action: manipulation;
  margin:0;
  color:var(--text);
  font-family:var(--font-body);
  background-image:url(Images/Unit1/plainbackground.webp);
  background-size:cover;
  background-attachment:fixed;
}

/* Make <main> exactly the viewport minus header */
main{
  height: calc(100dvh - var(--header-h));
  overflow: hidden;          /* no inner scroll either */
}


/* ------------------------------
   Header
------------------------------ */
.unit-title{
  transform: translateY(20px);
  margin-left: 10px;
  text-align: left;
  font-family: var(--font-heading);
  font-weight: 600;
  font-size: clamp(28px, 2.6svh, 26px);
  color:#ed2e2e;
}

/* ------------------------------
   WORD / IMAGE SLIDE (Grid)
------------------------------ */
.word-display{
  min-height: calc(100svh - var(--header-h));
  max-width: var(--max-content);
  margin: 0 auto;
  padding: clamp(16px, 3svh, 32px) 16px calc(16px + env(safe-area-inset-bottom));
  display: grid;
  grid-template-areas:
    "title"
    "image"
    "word"
    "nav";
  grid-template-rows:
    auto
    minmax(220px, var(--img-cap))
    minmax(90px, 18svh)
    auto;
  row-gap: clamp(10px, 1.8svh, 18px);
  justify-items: center;
}

/* Title row */
#lessonText{
  grid-area: title;
  margin: 12px 0 0;
  font-family:var(--font-heading);
  font-size: clamp(22px, 3.4svh, 38px);
  line-height:1.1;
  text-align:center;
  color: var(--salmon);
  text-shadow:
    0 0 0 rgb(236,226,226),
    1px 1px 0 rgb(236,226,226),
    -1px -1px 0 rgb(236,226,226),
    2px 2px 0 rgba(0,0,0,.08);
}

/* Image row */
.image-wrap{
  grid-area: image;
  width: min(520px, 86%);
  height: clamp(220px, var(--img-cap), 460px);
  margin: 0 auto;
  display:flex; align-items:center; justify-content:center;

  /* KEY: allow the image to visually extend, but reserve space equal to the shift */
  overflow: visible;                     /* was: hidden */
  padding-bottom: var(--img-shift);      /* creates safe room for the translate */
}

#wordImage{
  width:150%;
  height:170%;
  /* object-fit:contain; */
  display:block;
  filter: drop-shadow(0 8px 12px rgba(0,0,0,.18));
  /* border-radius:16px; */

  /* KEY: combine tiny nudge + safe visual shift using unified vars */
  transform: translateY(var(--base-shift)) scale(var(--base-scale));
  transform-origin:center;
  will-change: transform;
}

/* hard-stop any accidental inline margin that pushes the image down */
#wordImage{ margin-top: 0 !important; }

/* Nudge the word image down a tiny bit without changing layout/scroll */
.word-display.has-image{ --img-nudge:1px; }

/* Tiny float animation for intro mascot images; respects reduced motion */
body.intro-mascot #wordImage{
  animation: mascotFloat 1.5s var(--fx-ease) infinite;
  height: 115%;
  width: 125%;
}
@keyframes mascotFloat{
  0%,100% { transform: translateY(calc(var(--base-shift) - 2px)) scale(var(--base-scale)); }
  50%     { transform: translateY(calc(var(--base-shift) + 4px))  scale(var(--base-scale)); }
}
@media (prefers-reduced-motion: reduce){
  body.intro-mascot #wordImage{ animation: none !important; }
}

/* Word row */
.word-block{
  grid-area: word;
  display:flex; align-items:center; justify-content:center;
  width:100%;
  padding: 0 12px;
  /* Lift above any overlapping image edges and push down a touch */
  position: relative;
  z-index: 2;
  margin-top: clamp(24px, 9svh, 96px);
}
#wordText{
  font-family:var(--font-heading);
  font-weight:500;
  font-size: clamp(24px, 4.8svh, 36px);
  color: #000000ab;
  text-shadow:
    0 0 0 rgb(245,242,242),
    1.2px 1.2px 0 rgb(245,242,242),
    -1.2px -1.2px 0 rgb(245,242,242),
    2px 2px 0 rgba(0,0,0,.1);
  padding:2px 2px;
  padding-top: 90px;

  border-radius:12px;
  max-width:90%;
  text-align:center;
  white-space:normal;
  line-height:1.2;
}
/* Exception: make word text smaller on the last slide (often used as an outro) */
body.last-slide #wordText{
  font-size: clamp(20px, 3.4svh, 28px);
}

/* Extra breathing room on small phones */
@media (max-width: 480px){
  .word-block{ margin-top: clamp(32px, 12svh, 120px); }
}

/* ------------------------------
   NAV (Prev/Next coins)
------------------------------ */
.nav-row{
  grid-area: nav;
  width:100%;
  display:grid;
  gap: var(--btn-gap);
  margin:0;
}

/* coin button */
.nav-btn{
  width: var(--coin-size);
  height: var(--coin-size);
  min-width: 56px;
  min-height: 56px;
  border-radius: 50%;
  border: 0;
  padding: 0;
  background: transparent;
  box-shadow: none;
  font-size: 0; /* hides text, keep aria-label */
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.nav-btn .chevrons{ display:none; }

.nav-btn::before{
  content:"";
  position:absolute; inset:0; margin:auto;
  width:100%; height:100%;
  background: center/100% no-repeat;
  pointer-events:none;
  filter: drop-shadow(0 4px 6px rgba(0,0,0,.22));
}
.nav-btn:active::before{ transform: scale(.96); }

/* coin artwork (paths are case-sensitive!) */
.nav-btn.prev::before{ background-image:url("Images/buttons/24.png"); }
.nav-btn.next::before{ background-image:url("Images/buttons/25.png"); }

/* center the pair; 1 coin will auto-center when Prev is hidden */
.word-display .nav-row{
  display: grid;
  grid-template-columns: none;      /* cancel any 1fr 1fr from base */
  grid-auto-flow: column;
  grid-auto-columns: var(--coin-size);
  justify-content: center;
  justify-items: center;
  column-gap: var(--coin-gap);
  margin-bottom: clamp(8px, 2.4svh, 24px);
}
.nav-btn.prev, .nav-btn.next{ justify-self: auto; }

/* ------------------------------
   INTRO / OUTRO screens
------------------------------ */
.intro-screen{
  min-height: calc(100svh - var(--header-h));
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  text-align:center; gap:16px;
  padding: 20px 16px;
}
.intro-screen .nav-row{
  width:100%;
  display:grid;
  grid-template-columns:1fr;
  justify-items:center;
  margin-top:16px;
  padding-bottom:32px;
}

.intro-video-wrap{
  position:relative;
  width:min(680px, 92%);
  margin:0 auto;
  display:none;
}
.intro-video{
  width:100%;
  height:auto;
  max-height:56svh;
  border-radius:16px;
  box-shadow: 0 10px 18px rgba(0,0,0,.18);
  background: rgba(0,0,0,.2);
}
#introPlayOverlay{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  z-index:2; border:none; background:none; cursor:pointer; padding:0;
}
#introPlayOverlay::before{
  content:"";
  display:block;
  width:90px; height:90px;
  background-image:url("Images/Unit1/playbutton.webp");
  background-size:contain; background-repeat:no-repeat; background-position:center;
}
.intro-video::-webkit-media-controls-start-playback-button{ display:none !important; }

.intro-bottom-controls{
  position:absolute; left:50%; transform:translateX(-50%);
  bottom:max(16px, env(safe-area-inset-bottom));
  display:flex; align-items:center; justify-content:center; gap:12px;
  z-index: 3; /* above #introPlayOverlay (z-index:2) */
}


body.video-active { overflow:hidden; }
.video-active .unit-header { display:none; }

.intro-screen.video-fullscreen{
  position:fixed; inset:0; z-index:10;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:0; margin:0;
}
.intro-screen.video-fullscreen .intro-video-wrap{
  display:block; width:100vw; height:100svh;
}
.intro-screen.video-fullscreen .intro-video{
  width:100vw; height:100svh; max-height:none; border-radius:0;
  object-fit:contain; background:#000;
}
.intro-screen.video-fullscreen .nav-row{ display:none; }

/* ------------------------------
   GLOBAL FOOTER (coins)
------------------------------ */
.footer-actions{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: max(16px, env(safe-area-inset-bottom));
  z-index: 20;
  display: grid;
  gap: var(--btn-gap);
}

/* coinify the footer buttons (hide text, use images) */
.secondary-btn{
  border:0; outline:0; text-decoration:none;
  font-family:var(--font-body);
  font-weight:700;
  font-size: var(--btn-font);
  color:var(--white);
  background: transparent;
  height: var(--coin-size);
  width: var(--coin-size);
  border-radius: 50%;
  padding: 0;
  display:inline-flex; align-items:center; justify-content:center;
  box-shadow: none;
  cursor:pointer;
  white-space: nowrap;
  text-indent: 200%;
  overflow: hidden;
  position: relative; /* <-- needed so ::before sits on the button */
}
.secondary-btn .icon{ display:none; }

.secondary-btn.home::before,
.secondary-btn.startover::before{
  content:"";
  position:absolute; inset:0; margin:auto;
  width:100%; height:100%;
  background: center/100% no-repeat;
  filter: drop-shadow(0 4px 6px rgba(0,0,0,.22));
  pointer-events:none;
}
.secondary-btn.home::before{     background-image: url("Images/buttons/27.png"); }
.secondary-btn.startover::before{ background-image: url("Images/buttons/28.png"); }

#lessonActions.footer-actions{
  display: grid;
  grid-template-columns: none;      /* cancel 1fr 1fr */
  grid-auto-flow: column;
  grid-auto-columns: var(--coin-size);
  justify-content: center;
  justify-items: center;
  /* Tighten spacing specifically for the bottom dock */
  --coin-gap: clamp(6px, 2.2vw, 15px);
  column-gap: var(--coin-gap);
  /* Keep edge coins away from viewport corners and safe areas */
  padding-left:  max(16px, env(safe-area-inset-left));
  padding-right: max(10px, env(safe-area-inset-right));
}

/* ------------------------------
   Animations (outro)
------------------------------ */
.outro .mascot, .outro .message { will-change: transform, opacity; }
.outro .mascot { transform-origin: 80% 30%; }
.fx-pop { animation: outroPopIn var(--fx-dur-short) var(--fx-ease) both; }
@keyframes outroPopIn {
  0% { transform: scale(.9); opacity: 0; }
  60% { transform: scale(1.05); opacity: 1; }
  100% { transform: scale(1); }
}
.fx-wave-once { animation: outroWave 700ms ease-in-out both; }
@keyframes outroWave {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(-6deg) scale(1.005); }
  50% { transform: rotate(6deg) scale(.998); }
  100% { transform: rotate(0deg); }
}
.fx-float { animation: outroFloat 3s ease-in-out .8s infinite alternate; }
@keyframes outroFloat { from { transform: translateY(0); } to { transform: translateY(-6px); } }
.fx-cheer { animation: msgCheer var(--fx-dur-short) var(--fx-ease) both; }
@keyframes msgCheer {
  0% { transform: translateY(6px) scale(.98); opacity: 0; }
  60% { transform: translateY(-2px) scale(1.04); opacity: 1; }
  100% { transform: translateY(0) scale(1); }
}
@media (prefers-reduced-motion: reduce) {
  .fx-pop, .fx-wave-once, .fx-float, .fx-cheer { animation: none !important; transform: none !important; opacity: 1 !important; }
}

body.has-footer .word-display,
body.has-footer .intro-screen,
body.has-footer #outroScreen{
  padding-bottom: calc(16px + var(--footer-pad) + env(safe-area-inset-bottom));
}


/* Mascot outro: layout + safe sizing */
body.outro-active #outroScreen{
  display: grid !important;
  place-items: center;
  place-content: center;
  min-height: calc(100svh - var(--header-h));
  padding: clamp(8px, 2svh, 20px);
  text-align: center;
}

/* <- this is the missing bit */
body.outro-active #outroScreen .mascot{
  display: block;
  width: 125%;
  height: 125%;
  /* max-width: min(78vw, 560px);     
  max-height: min(46svh, 420px);    */
  object-fit: contain;
}

/* Tighten in short landscape */
@media (orientation: landscape) and (max-height: 520px){
  body.outro-active #outroScreen .mascot{ max-height: 36svh; }
}

/* If the footer is shown on outro, leave room for it */
body.outro-active{ --footer-pad: var(--coin-size); }
body.outro-active #outroScreen{
  padding-bottom: calc(16px + var(--footer-pad) + env(safe-area-inset-bottom));
}


/* Intro / Outro text bounce */
.intro-text{
  font-family: var(--font-heading);
  font-weight: 700;
  font-size: clamp(34px, 6svh, 52px);
  line-height: 1.3;
  text-align: center;
}

.intro-word{
  display: inline-block;
  opacity: 0;
  transform: translateY(12px) scale(.94);
  animation: intro-bounce .7s cubic-bezier(.2,.9,.25,1.4) forwards;
  margin-right: .4em;
}

@keyframes intro-bounce{
  0%   { opacity:0; transform: translateY(16px) scale(.92); }
  60%  { opacity:1; transform: translateY(-6px) scale(1.08); }
  80%  { transform: translateY(2px)  scale(.98); }
  100% { transform: translateY(0)    scale(1); }
}

@media (prefers-reduced-motion: reduce){
  .intro-word{ animation:none !important; opacity:1 !important; transform:none !important; }
}
/* iOS-safe: hide visible labels inside coin buttons (Home/Start Over) */
.secondary-btn.home,
.secondary-btn.startover{
  /* already sized as a coin elsewhere */
  font-size: 0;              /* collapse any text line-box */
  line-height: 0;
  white-space: nowrap;       /* prevent wrapping on iOS */
  text-indent: 0;            /* don't rely on indent tricks */
  color: transparent !important;
  -webkit-text-fill-color: transparent !important; /* iOS */
  text-shadow: none !important;
}

/* Nuke inner spans/emoji visually (icon is provided by ::before) */
.secondary-btn.home > *,
.secondary-btn.startover > * {
  display: none !important;
}

/* ===========================
   FIXED DOCK: Prev/Next + Footer
   =========================== */

/* Footer stays fixed (you already had this); keep as-is */
.footer-actions{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: max(16px, env(safe-area-inset-bottom));
  z-index: 20;
}

/* Make footer coins a tight row */
#lessonActions.footer-actions{
  display: grid;
  grid-template-columns: none;
  grid-auto-flow: column;
  grid-auto-columns: var(--coin-size);
  justify-content: center;
  justify-items: center;
  column-gap: var(--coin-gap);
}

/* NEW: when footer is visible, pin Prev/Next right above it */
body.has-dock .nav-row{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(env(safe-area-inset-bottom) + 16px + var(--coin-size) + var(--btn-gap)); /* sits above footer */
  z-index: 19;

  /* same geometry as elsewhere, but forced here */
  display: grid;
  grid-template-columns: none;
  grid-auto-flow: column;
  grid-auto-columns: var(--coin-size);
  justify-content: center;
  justify-items: center;
  column-gap: var(--coin-gap);
  width: auto;
}



/* Safety: kill any earlier 1fr/1fr layouts that could fight this */
body.has-dock .word-display .nav-row,
body.has-dock .intro-screen .nav-row{
  grid-template-columns: none;
}


.word-display,
.intro-screen,
#outroScreen{
  height: 100%;
  min-height: 0;             /* cancel earlier min-heights */
}

/* iOS: avoid 'fixed' background causing extra scroll area */
@supports (-webkit-touch-callout: none) {
  html, body{
    background-attachment: scroll !important;
  }
}

/* shrink the image area a bit when the fixed dock is visible */
body.has-dock .image-wrap{
  height: clamp(200px, 34svh, 420px);
}

/* a touch less vertical gap helps too */
body.has-dock .word-display{
  row-gap: clamp(8px, 1.6svh, 16px);
}

/* leave room equal to: footer coin + gap + nav coin + bottom padding */
body.has-dock .word-display,
body.has-dock .intro-screen,
body.has-dock #outroScreen{
  padding-bottom: calc(
    var(--coin-size)        /* footer */
    + var(--btn-gap)        /* gap */
    + var(--coin-size)      /* nav */
    + 24px                  /* breathing room */
    + env(safe-area-inset-bottom)
  );
}

/* Only for intro mascot slides (auto-flagged in JS) */
body.intro-mascot .word-display{
  grid-template-rows:
    auto
    minmax(220px, calc(var(--intro-mascot-cap) + var(--intro-mascot-shift)))
    minmax(0px, 0svh) /* collapse the word row entirely */
    auto;
  row-gap: clamp(6px, 1.2svh, 12px);
  /* trim top padding on intro slides to remove excess gap */
  padding-top: clamp(4px, 1svh, 12px);
}

body.intro-mascot .image-wrap{
  /* give the image room and prevent cropping */
  height: clamp(220px, var(--intro-mascot-cap), 560px);
  overflow: visible;
  padding-bottom: var(--intro-mascot-shift);
}

/* When in intro mascot mode, switch the unified vars for transform */
body.intro-mascot{
  --base-shift: var(--intro-mascot-shift);
  --base-scale: var(--intro-mascot-scale);
}

/* Remove any extra top margin on the (usually empty) lesson title */
body.intro-mascot #lessonText{ margin-top: 0; display:none; }
body.intro-mascot .word-block{ display:none !important; margin-top:0 !important; }

/* Dock-aware: bias a tad more when the fixed footer is visible */
body.has-dock.intro-mascot{
  --intro-mascot-cap: 42svh;
  --intro-mascot-shift: 1svh;
}

/* (optional) per-unit tuning */
body.unit-unit5.intro-mascot{
  --intro-mascot-scale: 1.18;
  --intro-mascot-shift: 1svh;
}

/* ===========================
   START GATE (iOS autoplay unlock)
   =========================== */
   .start-gate{
    position: fixed;
    inset: 0;
    z-index: 50;
    display: grid;
    place-items: center;
    background: linear-gradient(180deg, var(--sky1), var(--sky2));
    padding: 24px;
  }
  
  .start-gate .gate-wrap{
    display: grid;
    gap: 16px;
    place-items: center;
    text-align: center;
  }
  
  .gate-title{
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: clamp(28px, 6svh, 52px);
    color: #1c2b4a;
    margin: 0;
    text-shadow: 0 2px 12px rgba(0,0,0,.08);
  }
  
  .gate-note{
    font-size: clamp(14px, 2.2svh, 18px);
    color: rgba(0,0,0,.65);
    margin: 0 0 8px 0;
  }
  
  .gate-start{
    appearance: none;
    border: 0;
    padding: 14px 28px;
    border-radius: 999px;
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: clamp(18px, 2.6svh, 22px);
    cursor: pointer;
    background: linear-gradient(180deg, #ffdf7a, #ffb300);
    box-shadow: 0 10px 18px rgba(0,0,0,.18);
    transition: transform .06s ease, filter .2s ease;
  }
  .gate-start:active{ transform: translateY(1px) scale(.98); }

  
  
